<% if is_owner? @adventure %>
    <%= render partial: "shared/edit_plan", locals: { form_model: @adventure, form_url: adventure_path(@campaign['slug'], @adventure['slug']), type: 'Adventure' } %>
<% end %>

<div class="container m-5">
    <h1><%= @adventure['title'] %></h1>
    <p><a href="<%= campaign_path @campaign['slug'] %>">Go to Campaign</a></p>
    <h4><%= @adventure['subtitle'] %></h4>
    <p><%= @adventure['description'] %></p>
    <p>Dates: <%= @adventure['date_started'] %> - <%= @adventure['date_ended'] %></p>

    <% if is_owner? @adventure %>
        <h3 class="mt-5">Private Notes:</h3>
        <p><%= markdown @adventure['private_notes'] %></p>
    <% end %>

    <h3 class="mt-5">Shared Notes:</h3>
    <p><%= markdown @adventure['shared_notes'] %></p>
</div>

<div class="container m-5">
    <h4>Comments</h4>
    <ul class="list-group list-group-flush mb-3">
        <% for comment in @comments %>
            <li class="list-group-item">
                <strong><%= comment.user.username %></strong>
                <p class="mb-0"><small style="font-size: 12px; color: #777; padding-top: 0;"><%= comment.created_at.to_formatted_s(:short) %> UTC</small></p>
                <%= markdown comment.text %>
            </li>
        <% end %>
    </ul>

    <% if is_logged_in? %>
        <%= form_with(model: [@adventure, Comment.new], local: true) do |form| %>
            <div class="mb-3">
                <%= form.label :text, "Add comment" %>
                <%= form.text_area :text, placeholder: "Add a comment...", class: "form-control" %>
                <%= form.hidden_field :adventure_id, value: @adventure.id %>
            </div>
            <%= form.submit "Add Comment", class: "btn btn-primary" %>
        <% end %>
    <% end %>
</div>